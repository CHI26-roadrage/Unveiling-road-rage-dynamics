<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>R³-Ftg Dataset</title>
  <style>
    :root {
      --maxw: 1200px;
      --fg: #333;
      --bg: #f9fafb;
      --muted: #6b7280;
      --primary: #2563eb;
      --card: #ffffff;
      --shadow: 0 4px 10px rgba(0,0,0,0.06);
      --radius: 12px;
      --border: #e5e7eb;
      --head: #f3f4f6;
      --tag-bg: #eef2ff;
      --tag-fg: #3730a3;
      --tag-bd: #e0e7ff;
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "PingFang SC", "Microsoft YaHei", sans-serif;
      color: var(--fg);
      background: var(--bg);
      padding: 20px;
    }

    a { color: var(--primary); text-decoration: none; }
    a:hover { text-decoration: underline; }

    header {
      max-width: var(--maxw);
      margin: 0 auto 18px;
      display: flex;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
    }
    .back {
      border: 1px solid var(--border);
      background: #fff;
      padding: 8px 12px;
      border-radius: 8px;
      box-shadow: var(--shadow);
      font-size: 14px;
    }

    .intro {
      max-width: var(--maxw);
      margin: 0 auto 16px;
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 16px 18px;
      line-height: 1.8;
    }

    h1 {
      font-size: clamp(1.2rem, 1rem + 1.6vw, 1.8rem);
      margin: 0 0 8px;
    }
    .muted { color: var(--muted); }

    /* Controls */
    .controls {
      max-width: var(--maxw);
      margin: 0 auto 12px;
      display: flex;
      gap: 10px;
      align-items: center;
      flex-wrap: wrap;
    }
    .ctrl {
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 8px 10px;
      box-shadow: var(--shadow);
      font-size: 14px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    select, input[type="text"] {
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 6px 8px;
      background: #fff;
      font-size: 14px;
      min-width: 140px;
    }

    /* table-like grid */
    .grid {
      max-width: var(--maxw);
      margin: 0 auto;
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: 1px solid var(--border);
      overflow: hidden;
    }
    .grid-head, .grid-row {
      display: grid;
      grid-template-columns: 160px 1fr 180px; /* 图片 / physical conditions / 类别 */
      gap: 0;
      align-items: center;
    }
    .grid-head {
      background: var(--head);
      font-weight: 600;
      color: #374151;
      border-bottom: 1px solid var(--border);
    }
    .cell {
      padding: 10px 12px;
      border-bottom: 1px solid var(--border);
      font-size: 14px;
    }
    .cell.img { padding: 6px; }
    .thumb {
      width: 100%;
      height: 100px;
      object-fit: cover;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: #fafafa;
    }
    .tag {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 999px;
      background: var(--tag-bg);
      color: var(--tag-fg);
      font-weight: 600;
      font-size: 12px;
      border: 1px solid var(--tag-bd);
    }

    /* Responsive */
    @media (max-width: 820px) {
      .grid-head, .grid-row {
        grid-template-columns: 120px 1fr 140px;
      }
      .thumb { height: 86px; }
    }
    @media (max-width: 560px) {
      .grid-head { display: none; }
      .grid-row {
        grid-template-columns: 120px 1fr;
        grid-auto-rows: auto;
      }
      .cell.cat { grid-column: 1 / -1; border-top: 0; }
      .thumb { height: 90px; }
    }
  </style>
</head>
<body>
  <header>
    <a class="back" href="index.html">← 返回主页</a>
  </header>

  <section class="intro">
    <h1>R<sup>3</sup>-Ftg 数据集</h1>
    <p>
      这里是 R<sup>3</sup>-Ftg 是数据集的介绍，由于本文正在审阅阶段，我们不方便透露我们的信息以及数据集更多细节。
      如果您需要我们的数据集，请发文到 <strong>XXXXX</strong> 并提供您的信息，我们经过评审后会回复您。
    </p>
    <p class="muted">下表展示 81 个视频的示例封面图（左列），包含固定的 physical conditions 与自动推断的类别标签。</p>
  </section>

  <!-- 可选筛选/搜索 -->
  <div class="controls">
    <div class="ctrl">
      <label for="condFilter">Physical conditions:</label>
      <select id="condFilter">
        <option value="all">All</option>
        <option value="sunny">sunny</option>
        <option value="cloudy">cloudy</option>
        <option value="overcast">overcast</option>
        <option value="night">night</option>
      </select>
    </div>
    <div class="ctrl">
      <label for="catFilter">类别:</label>
      <select id="catFilter">
        <option value="all">全部</option>
        <option value="provocation">挑衅驾驶（0p）</option>
        <option value="danger">危险驾驶（1p）</option>
        <option value="obstruction">阻碍驾驶（2p）</option>
      </select>
    </div>
    <div class="ctrl">
      <label for="search">搜索文件名:</label>
      <input id="search" type="text" placeholder="输入文件名关键字"/>
    </div>
  </div>

  <!-- 表格 -->
  <section class="grid" id="grid">
    <div class="grid-head">
      <div class="cell">样例图像</div>
      <div class="cell">Physical conditions</div>
      <div class="cell">类别</div>
    </div>
    <!-- 行内容由 JS 生成 -->
  </section>

  <script>
    // 依据更正后的命名规则自动生成 81 条路径
    // 0p: 0.jpg - 23.jpg
    const zeroP = Array.from({length: 24}, (_, i) => `0p/${i}.jpg`);
    // 1p: 0.jpg - 49.jpg
    const oneP = Array.from({length: 50}, (_, i) => `1p/${i}.jpg`);
    // 2p: 0.jpg - 6.jpg
    const twoP = Array.from({length: 7}, (_, i) => `2p/${i}.jpg`);

    // 合并为 81 项，顺序为 0p -> 1p -> 2p
    const items = [...zeroP, ...oneP, ...twoP];

    // 为每一条固定 physical conditions（长度需与 items 完全一致）
    // 示例分配方案（可按你需要直接修改此数组）：
    // - 0p（24）: 前6 sunny，后6 cloudy，再6 overcast，最后6 night
    // - 1p（50）: 以10为一组轮换 sunny, cloudy, overcast, night, sunny
    // - 2p（7）: 依次 sunny, cloudy, overcast, night, sunny, cloudy, overcast
    const conditions = [
      // 0p (24)
      ...Array(6).fill('sunny'), ...Array(6).fill('cloudy'),
      ...Array(6).fill('overcast'), ...Array(6).fill('night'),
      // 1p (50)
      ...Array(10).fill('sunny'), ...Array(10).fill('cloudy'),
      ...Array(10).fill('overcast'), ...Array(10).fill('night'),
      ...Array(10).fill('sunny'),
      // 2p (7)
      'sunny','cloudy','overcast','night','sunny','cloudy','overcast'
    ];

    if (conditions.length !== items.length) {
      console.warn('conditions 数组长度与 items 不一致：', conditions.length, items.length);
    }

    function guessCategory(path) {
      if (path.startsWith('0p/')) return { key: 'provocation', label: '挑衅驾驶（0p）' };
      if (path.startsWith('1p/')) return { key: 'danger', label: '危险驾驶（1p）' };
      if (path.startsWith('2p/')) return { key: 'obstruction', label: '阻碍驾驶（2p）' };
      return { key: 'unknown', label: '未知' };
    }

    // 构建数据对象（使用固定 conditions，不再随机）
    const data = items.map((path, idx) => ({
      path,
      file: path.split('/').pop(),
      cond: conditions[idx] || 'sunny',
      cat: guessCategory(path)
    }));

    // 渲染
    const grid = document.getElementById('grid');

    function makeRow(item) {
      const row = document.createElement('div');
      row.className = 'grid-row';
      row.innerHTML = `
        <div class="cell img">
          <img class="thumb" src="${item.path}" alt="${item.cat.label} 封面图 ${item.file}" onerror="this.style.opacity=0.3;this.alt='图片未找到';">
        </div>
        <div class="cell">${item.cond}</div>
        <div class="cell cat"><span class="tag">${item.cat.label}</span></div>
      `;
      return row;
    }

    function render(list) {
      // 清除旧行（保留表头）
      grid.querySelectorAll('.grid-row').forEach(r => r.remove());
      // 渲染
      const frag = document.createDocumentFragment();
      list.forEach(item => frag.appendChild(makeRow(item)));
      grid.appendChild(frag);
    }

    // 过滤与搜索
    const condFilter = document.getElementById('condFilter');
    const catFilter = document.getElementById('catFilter');
    const search = document.getElementById('search');

    function applyFilters() {
      const condVal = condFilter.value;
      const catVal = catFilter.value;
      const keyword = search.value.trim().toLowerCase();

      const filtered = data.filter(d => {
        const okCond = condVal === 'all' || d.cond === condVal;
        const okCat = catVal === 'all' || d.cat.key === catVal;
        const okKw = !keyword || d.file.toLowerCase().includes(keyword);
        return okCond && okCat && okKw;
      });

      render(filtered);
    }

    condFilter.addEventListener('change', applyFilters);
    catFilter.addEventListener('change', applyFilters);
    search.addEventListener('input', applyFilters);

    // 初次渲染
    render(data);
  </script>
</body>
</html>